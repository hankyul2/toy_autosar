/** @file     Rte_APP_HIGHBEAM.c
  * 
  * @brief    RTE Sample SWC implementation skeleton file
  * 
  * @note     Generated by ETAS GmbH  RTA-RTE v5.8.4  (R4.0 backend version: v7.8.7 (Build 46772))
  */

#include "Rte_APP_HIGHBEAM.h"
#define MIN_DISTANCE 150
typedef enum _LightConstVar {off, lowBeam, highBeam} LightConstVar;
/* --------------------------------------------------------------------------- */
/* RTE Event: /Components/APP_HIGHBEAM/IB_APP_HIGHBEAM/DRE_DISTANCE */

FUNC(void, APP_HIGHBEAM_CODE) RE_HIGHBEAM(void)
{
	int distance;
	int lightMode;
	int voltage = 0;
	Rte_Read_R_DISTANCE_FROM_SENSOR_DISTANCE_VDP_SENSOR_TO_APP(&distance);
	Rte_Read_R_LIGHTMODE_FROM_SENSOR_LIGHTMODE_VDP_SENSOR_TO_APP(&lightMode);

	switch(lightMode){
		case off:
			voltage = 0;
			break;
		case lowBeam:
			voltage = 0;
			break;
		case highBeam:
			if (distance < MIN_DISTANCE){
				voltage = 0;
			} else {
				voltage = 1;
			}
			break;
	}

	Rte_Write_P_HIGHBEAMMODE_TO_ACT_HIGHBEAM_VDP_APP_TO_ACT(voltage);
}

