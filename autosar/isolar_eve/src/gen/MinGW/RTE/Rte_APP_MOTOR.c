/** @file     Rte_APP_MOTOR.c
  * 
  * @brief    RTE Sample SWC implementation skeleton file
  * 
  * @note     Generated by ETAS GmbH  RTA-RTE v5.8.4  (R4.0 backend version: v7.8.7 (Build 46772))
  */

#include "Rte_APP_MOTOR.h"

/* --------------------------------------------------------------------------- */
/* RTE Event: /Components/APP_MOTOR/IB_APP_MOTOR/DRE_SPEED */

FUNC(void, APP_MOTOR_CODE) RE_MOTOR(void)
{
	int speed;
	int steering;
	int lrDegree = 0;
	int upDegree = 0;
	speed = Rte_DRead_R_SPEED_FROM_SENSOR_SPEED_VDP_SENSOR_TO_APP();
	steering = Rte_DRead_R_STEERING_FROM_SENSOR_STEERINGANGLE_VDP_SENSOR_TO_APP();
	steering = steering > 100 ? -(steering - 100) : steering;
	lrDegree = (int)((double)steering * 0.9);
	if(speed < 50){
		upDegree = -45;
	} else if (speed < 100){
		upDegree = -30;
	} else {
		upDegree = -15;
	}
	Rte_Write_P_LEFTRIGHTANGLE_TO_ACT_LEFTRIGHT_MOTOR_VDP_APP_TO_ACT(lrDegree);
	Rte_Write_P_UPDOWNANGLE_TO_ACT_UPDOWN_MOTOR_VDP_APP_TO_ACT(upDegree);
}

